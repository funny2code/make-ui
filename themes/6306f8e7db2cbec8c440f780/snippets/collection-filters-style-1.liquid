{{ 'component-filter-style-1.css' | asset_url | stylesheet_tag }}
<div class="page-width collection-filters bc-collection-page-fillters py-{{section.settings.filter_bg_color}} py-{{section.settings.filter_color}}" id="main-collection-filters" data-id="{{ section.id }}">
    {%- if section.settings.enable_filtering or section.settings.enable_sorting -%}
      {%- assign total_active_values = 0 -%}
      <collection-filters-form class="facets small-hide">
        <form id="CollectionFiltersForm" class="facets__form">
          {%- if section.settings.enable_sorting -%}
            <div class="collection-filters__item sorting">
              <details class="disclosure-has-popup facets__disclosure js-filter" data-index="tag-0">              
                <summary class="facets__summary">
                  <div>
                    <label class="collection-filters__label" for="SortBy">{{ 'sections.collection_template.sort_by_label' | t }}</label>
                    <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-caret" viewBox="0 0 10 6">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor">
                    </path></svg>

                  </div>
                </summary>
                <div class="facets__display">
                  <div class="select">
                    {%- assign sort_by = collection.sort_by | default: collection.default_sort_by -%}
                    <select name="sort_by" class="select__select collection-filters__sort" id="SortBy" aria-describedby="a11y-refresh-page-message">
                      {%- for option in collection.sort_options -%}
                        <option value="{{ option.value | escape }}"{% if option.value == sort_by %} selected="selected"{% endif %}>{{ option.name | escape }}</option>
                      {%- endfor -%}
                    </select>
                    {% render 'icon-caret' %}
                  </div>
                </div>
              </details>

              <noscript>
                <button type="submit" class="button button--small">{{ 'sections.collection_template.sort_button' | t }}</button>
              </noscript>
            </div>
          {%- endif -%}
          {% if section.settings.enable_filtering %}
            {%- if section.blocks.size > 0 -%}

              {%- for block in section.blocks -%}                
              {%- if block.type == 'filter' -%}
                {%- assign filterName = block.settings.label | downcase -%}                              
                {%- if filterName == 'colors' or filterName == 'color'  -%}                
                  <details class="disclosure-has-popup facets__disclosure js-filter" data-index="tag-{{ forloop.index }}">
                    <summary class="facets__summary">
                      <div>
                        <span>{{ block.settings.label | escape }}</span>
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div class="facets__display">

                      {%- assign filterTagNames = '' | split: ',' -%}                      
                      {%- if collection.products.size > 0 -%}
                        <ul class="facets__list list-unstyled color_filter_list Filter-{{ block.settings.label | escape }}" role="list">
                        {%- for prod in collection.products -%}
                          {%- assign colorTitle = prod.title | split: ' / ' | last -%}        
                          {%- assign color = colorTitle | strip | replace: ' ', '-' | downcase  -%}                    
                          {% if filterTagNames contains colorTitle %}
                            {{ continue }}
                          {% else %}
                          {% assign new_color = colorTitle | split: ", " %}
                          {% assign filterTagNames = filterTagNames | concat: new_color %}
                          <li class="list-menu__item facets__item">
                            <label style="align-items: center;" for="Filter-{{ block.settings.label | escape }}-{{ forloop.index }}" class="facet-checkbox">
                              <input style="display:none" type="checkbox"
                                data-type="true"
                                name="Filter-{{ block.settings.label | escape }}"
                                value="{{ color }}"
                                id="Filter-{{ block.settings.label | escape }}-{{ forloop.index }}"
                                onclick="selectOnlyThis(this,'Filter-{{ block.settings.label | escape }}')"
                                {% if current_tags contains color %}checked{% endif %}
                              >

                              <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                              </svg>

                              <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                              </svg>
                              {{ colorTitle }}
                              
                              <span style="margin-bottom:0px;margin-left:5px;height: 20px;width: 20px;border-radius:5px;" class="bc-colors__icon" data-color="{{color}}"></span>
                              
                            </label>
                          </li>
                        {% endif %}
                        {%- endfor -%}                      
                        </ul>
                      {% endif %}
                    </div>
                  </details>
                {% else %}
                  <details class="disclosure-has-popup facets__disclosure js-filter" data-index="tag-{{ forloop.index }}">
                    <summary class="facets__summary">
                      <div>
                        <span>{{ block.settings.label | escape }}</span>
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div class="facets__display">

                      {%- assign filterTagNames = block.settings.tags | split: '|' -%}
                      {%- assign filterPrefix = block.settings.tag_prefix -%}

                      <ul class="facets__list list-unstyled Filter-{{ block.settings.label | escape }}" role="list">
                        {%- for name in filterTagNames -%}
                          <li class="list-menu__item facets__item">
                            <label style="align-items: center;" for="Filter-{{ block.settings.label | escape }}-{{ forloop.index }}" class="facet-checkbox">
                              <input style="display:none" type="checkbox"
                                data-type="true"
                                name="Filter-{{ block.settings.label | escape }}"
                                value="{{ filterPrefix }}{{ name }}"
                                id="Filter-{{ block.settings.label | escape }}-{{ forloop.index }}"
                                onclick="selectOnlyThis(this,'Filter-{{ block.settings.label | escape }}')"
                                {% if current_tags contains name %}checked{% endif %}
                              >

                              <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                              </svg>

                              <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                              </svg>
                              {{ name | replace: '-', ' ' | capitalize }}
                              {%- assign filterName = block.settings.label | downcase -%}
                              {%- assign colorId = name | strip | replace: ' ', '_' | downcase  -%}
                              {%- if filterName == 'colors' or filterName == 'color'  -%}
                              <span style="margin-bottom:0px;margin-left:5px;height: 20px;width: 20px;border-radius:5px;" class="bc-colors__icon" data-color="{{colorId}}"></span>
                              {%- endif -%}
                            </label>
                          </li>
                        {%- endfor -%}
                      </ul>
                    </div>
                  </details>
                {% endif %}
              {%- endif -%}
              {%- endfor -%}

            {%- endif -%}

          
            <div class="facets__wrapper">              

              {%- for filter in collection.filters -%}
                {%- assign total_active_values = total_active_values | plus: filter.active_values.size -%}
                {% case filter.type %}
                {% when 'list' %}
                  <details class="disclosure-has-popup facets__disclosure js-filter" data-index="{{ forloop.index }}">
                    <summary class="facets__summary">
                      <div>
                        <span>{{ filter.label | escape }}</span>
                        <span class="count-bubble">{%- if filter.active_values.size > 0 -%}{{ filter.active_values.size }}{%- endif -%}</span>
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div class="facets__display">
                      <div class="facets__header">
                        <span class="facets__selected no-js-hidden">{{ 'sections.collection_template.filters_selected' | t: count: filter.active_values.size }}</span>
                        <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link js-facet-remove" >{{ 'sections.collection_template.reset' | t }}</a>
                      </div>

                      <ul class="facets__list list-unstyled Filter--aaa" role="list">
                        {%- for value in filter.values -%}
                          <li class="list-menu__item facets__item">
                            <label for="Filter-{{ filter.label | escape }}-{{ forloop.index }}" class="facet-checkbox{% if value.count == 0 and value.active == false %} facet-checkbox--disabled{% endif %}">
                              <input style="display:none" type="checkbox"
                                name="{{ value.param_name }}"
                                value="{{ value.value }}"
                                id="Filter-{{ filter.label | escape }}-{{ forloop.index }}"
                                onclick="selectOnlyThis(this,'Filter-{{ block.settings.label | escape }}')"
                                {% if value.active %}checked{% endif %}
                                {% if value.count == 0 and value.active == false %}disabled{% endif %}
                              >

                              <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                              </svg>

                              <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                              </svg>
                              {{ value.label | escape }} ({{ value.count }})
                            </label>
                          </li>
                        {%- endfor -%}
                      </ul>
                    </div>
                  </details>
                {% when 'price_range' %}
                  {% liquid
                    assign currencies_using_comma_decimals = 'ANG,ARS,BRL,BYN,BYR,CLF,CLP,COP,CRC,CZK,DKK,EUR,HRK,HUF,IDR,ISK,MZN,NOK,PLN,RON,RUB,SEK,TRY,UYU,VES,VND' | split: ','
                    assign uses_comma_decimals = false
                    if currencies_using_comma_decimals contains cart.currency.iso_code
                      assign uses_comma_decimals = true
                    endif
                  %}
                  <details class="disclosure-has-popup facets__disclosure js-filter" data-index="{{ forloop.index }}">
                    <summary class="facets__summary">
                      <div>
                        <span>{{ filter.label | escape }}</span>
                        <span class="count-bubble{%- if filter.min_value.value or filter.max_value.value -%}{{ filter.active_values.size }} count-bubble--dot{% endif %}"></span>
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div class="facets__display">
                      <div class="facets__header">
                        {%- assign max_price_amount = filter.range_max | money | escape -%}
                        <span class="facets__selected">{{ "sections.collection_template.max_price" | t: price: max_price_amount }}</span>
                        <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link js-facet-remove" >{{ 'sections.collection_template.reset' | t }}</a>
                      </div>
                      <price-range class="facets__price">
                        <div class="field">
                          <span class="field__currency">{{ cart.currency.symbol }}</span>
                          <input class="field__input"
                            name="{{ filter.min_value.param_name }}"
                            id="Filter-{{ filter.label | escape }}-{{ forloop.index }}"
                            {%- if filter.min_value.value -%}
                              {%- if uses_comma_decimals -%}
                                value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                              {%- else -%}
                                value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                              {% endif %}
                            {%- endif -%}
                            type="number"
                            placeholder="0"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"/>
                          <label class="field__label" for="Search-In-Modal">{{ 'sections.collection_template.from' | t }}</label>
                        </div>
                        <div class="field">
                          <span class="field__currency">{{ cart.currency.symbol }}</span>
                          <input class="field__input"
                            name="{{ filter.max_value.param_name }}"
                            id="Filter-{{ filter.label | escape }}-{{ forloop.index }}"
                            {%- if filter.max_value.value -%}
                              {%- if uses_comma_decimals -%}
                                value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                              {%- else -%}
                                value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                              {% endif %}
                            {%- endif -%}
                            type="number"
                            placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"/>
                          <label class="field__label" for="Search-In-Modal">{{ 'sections.collection_template.to' | t }}</label>
                        </div>
                      </div>
                    </price-range>
                  </details>
                {% endcase %}
              {%- endfor -%}
              <noscript>
                <button type="submit" class="facets__button button">{{ 'sections.collection_template.filter_button' | t }}</button>
              </noscript>
            </div>
          {% endif %}

          <div class="active-facets active-facets-desktop">
            <a href="{{ collection.url }}?sort_by={{ sort_by }}" class="active-facets__button button button--secondary js-facet-remove" {% if current_tags != blank %}data-type="clear_all"{% endif %}>{{ 'sections.collection_template.clear_all' | t }}</a>
            {%- for filter in collection.filters -%}
              {%- for value in filter.active_values -%}
                <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ value.url_to_remove }}" data-value="{{ value.value | escape }}">
                  {{ value.label | escape }}
                  {% render 'icon-close-small' %}
                </a>
              {%- endfor -%}
              {% if filter.type == "price_range" %}
                {%- if filter.min_value.value != nil or filter.max_value.value != nil -%}
                  <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ filter.url_to_remove }}" >
                    {%- if filter.min_value.value -%}{{ filter.min_value.value | money }}{%- else -%}{{ 0 | money }}{%- endif -%}-{%- if filter.max_value.value -%}{{ filter.max_value.value | money }}{%- else -%}{{ filter.range_max | money }}{%- endif -%}
                    {% render 'icon-close-small' %}
                  </a>
                {%- endif -%}
              {% endif %}
            {%- endfor -%}
            {%- if current_tags != blank -%}
              {%- for tag in current_tags -%}
                <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ tag | escape }}" data-value="{{ tag | escape }}" data-type="{{ tag | escape }}">
                  {{ tag | remove: "C_COVERAGES_" | remove: "C_FABRICS_" | remove: "C_TYPES_" | escape }}
                  {% render 'icon-close-small' %}
                </a>
              {%- endfor -%}
            {%- endif -%}
          </div>

          {% if collection.current_vendor or collection.current_type %}
            <input type="hidden" name="q" value="{{ collection.current_vendor }}{{ collection.current_type }}">
          {% endif %}
        </form>
      </collection-filters-form>
      
      <menu-drawer class="mobile-facets__wrapper">
        <details class="disclosure-has-popup medium-hide large-up-hide">
          <summary>
            <span class="mobile-facets__open button button--secondary">
              <span>SHOW FILTERS</span>
              <span class="count-bubble">
                {%- if total_active_values > 0 -%}{{ total_active_values }}{%- endif -%}
              </span>
            </span>
            <span tabindex="0" class="mobile-facets__close mobile-facets__close--no-js">{%- render 'icon-close' -%}</span>
          </summary>
          <collection-filters-form>
            <form id="CollectionFiltersFormMobile" class="mobile-facets py-{{section.settings.filter_bg_color}}">
              <div class="mobile-facets__inner">
                <div class="mobile-facets__header py-{{section.settings.filter_bg_color}}">
                  <div class="mobile-facets__header-inner">
                    <h2 class="mobile-facets__heading">{{ 'sections.collection_template.filter_and_sort' | t }}</h2>
                    <p class="mobile-facets__count">{{ 'sections.collection_template.product_count' | t: product_count: collection.products_count, count: collection.all_products_count }}</p>
                  </div>
                </div>
                <div class="mobile-facets__main">
                  {%- if section.settings.enable_sorting -%}
                    <div class="mobile-facets__details js-filter" data-index="mobile-{{ forloop.index }}">
                      <div class="mobile-facets__summary">
                        <div class="mobile-facets__sort">
                          <label for="SortBy-mobile">{{ 'sections.collection_template.sort_by_label' | t }}</label>
                          <div class="select">
                            <select name="sort_by" class="select__select" id="SortBy-mobile" aria-describedby="a11y-refresh-page-message">
                              {%- for option in collection.sort_options -%}
                                <option value="{{ option.value | escape }}"{% if option.value == sort_by %} selected="selected"{% endif %}>{{ option.name | escape }}</option>
                              {%- endfor -%}
                            </select>
                            {% render 'icon-caret' %}
                          </div>
                        </div>
                      </div>
                    </div>
                  {%- endif -%}


                  {% if section.settings.enable_filtering %}
                    {% assign filter_block = 0 %}
                    {%- if section.blocks.size > 0 -%}                      
                      {%- for block in section.blocks -%}
                        {%- if block.type == 'filter' -%}
                          {% assign filter_block = filter_block | plus: 1 %}
                          {%- assign filterTagNames = block.settings.tags | split: '|' -%}
                          {%- assign filterPrefix = block.settings.tag_prefix -%}
                          {%- assign filterName = block.settings.label | downcase -%}                              
                          {%- if filterName == 'colors' or filterName == 'color'  -%}                
                            <details class="mobile-facets__details js-filter tag_filter" data-index="mobile-{{ forloop.index }}">
                              <summary class="mobile-facets__summary">
                                <div>
                                  <span>{{ block.settings.label | escape }}</span>                               
                                  <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                                  <noscript>{% render 'icon-caret' %}</noscript>
                                </div>
                              </summary>
                              <div class="mobile-facets__submenu py-{{section.settings.filter_bg_color}}">
                                <button class="mobile-facets__close-button link link--text focus-inset" aria-expanded="true" type="button">
                                  {% render 'icon-arrow' %}
                                  {{ block.settings.label | escape }}
                                </button> 
                                  {%- assign filterTagNames = '' | split: ',' -%}                      
                                  {%- if collection.products.size > 0 -%}
                                    <ul class="mobile-facets__list list-unstyled" role="list">                        
                                    {%- for prod in collection.products -%}
                                      {%- assign colorTitle = prod.title | split: ' / ' | last -%}        
                                      {%- assign color = colorTitle | strip | replace: ' ', '-' | downcase  -%}                    
                                      {% if filterTagNames contains colorTitle %}
                                        {{ continue }}
                                      {% else %}
                                      {% assign new_color = colorTitle | split: ", " %}
                                      {% assign filterTagNames = filterTagNames | concat: new_color %}                    

                                      <li class="mobile-facets__item list-menu__item">
                                        <label for="Filter-{{ block.settings.label | escape }}-mobile-{{ forloop.index }}" class="mobile-facets__label">
                                          <input class="mobile-facets__checkbox"
                                            type="checkbox"
                                            data-type="true"
                                            name="Filter-mobile-{{ block.settings.label | escape }}"
                                            value="{{ color }}"
                                            id="Filter-{{ block.settings.label | escape }}-mobile-{{ forloop.index }}"
                                            onclick="selectOnlyThis(this,'Filter-mobile-{{ block.settings.label | escape }}')"
                                            {% if current_tags contains color %}checked{% endif %}                                        
                                          >

                                          <span class="mobile-facets__highlight"></span>

                                          <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                            <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                                          </svg>

                                          <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                                          </svg>

                                          {{ colorTitle }}<span style="margin-bottom:0px;margin-left:5px;height: 20px;width: 20px;border-radius:5px;" class="bc-colors__icon" data-color="{{color}}"></span>
                                          
                                        </label>
                                      </li>
                                    {% endif %}
                                    {%- endfor -%}                      
                                    </ul>
                                  {% endif %}
                                </div>
                            </details>
                          {% else %}
                            <details class="mobile-facets__details js-filter tag_filter" data-index="mobile-{{ forloop.index }}">
                              <summary class="mobile-facets__summary">
                                <div>
                                  <span>{{ block.settings.label | escape }}</span>                               
                                  <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                                  <noscript>{% render 'icon-caret' %}</noscript>
                                </div>
                              </summary>
                              <div class="mobile-facets__submenu py-{{section.settings.filter_bg_color}}">
                                <button class="mobile-facets__close-button link link--text focus-inset" aria-expanded="true" type="button">
                                  {% render 'icon-arrow' %}
                                  {{ block.settings.label | escape }}
                                </button>
                                <ul class="mobile-facets__list list-unstyled" role="list">
                                  {%- for name in filterTagNames -%}
                                    <li class="mobile-facets__item list-menu__item">
                                      <label for="Filter-{{ block.settings.label | escape }}-mobile-{{ forloop.index }}" class="mobile-facets__label">
                                        <input class="mobile-facets__checkbox"
                                          type="checkbox"
                                          data-type="true"
                                          name="Filter-mobile-{{ block.settings.label | escape }}"
                                          value="{{ filterPrefix }}{{ name }}"
                                          id="Filter-{{ block.settings.label | escape }}-mobile-{{ forloop.index }}"
                                          onclick="selectOnlyThis(this,'Filter-mobile-{{ block.settings.label | escape }}')"
                                          {% if current_tags contains name %}checked{% endif %}                                        
                                        >
      
                                        <span class="mobile-facets__highlight"></span>
      
                                        <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                          <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                                        </svg>
      
                                        <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                          <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                                        </svg>
      
                                        {{ name | replace: '-', ' ' | capitalize }}
                                      </label>
                                    </li>
                                  {%- endfor -%}
                                </ul>
      
                                <div class="no-js-hidden mobile-facets__footer py-{{section.settings.filter_bg_color}}">
                                  <a href="{{ collection.url }}" class="mobile-facets__clear button button--secondary js-facet-remove">{{ 'sections.collection_template.clear' | t }}</a>
                                  <button type="button" class="no-js-hidden button button--primary" onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()">{{ 'sections.collection_template.apply' | t }}</button>
                                  <noscript><button class="button button--primary">{{ 'sections.collection_template.apply' | t }}</button></noscript>
                                </div>
                              </div>
                            </details>
                          {% endif %}             
                        {% endif %}
                      {% endfor %}
                    {% endif %}                  


                    {%- for filter in collection.filters -%}
                      {% case filter.type %}
                      {% when 'list' %}
                        <details class="mobile-facets__details js-filter" data-index="mobile-{{ forloop.index | plus: filter_block }}">
                          <summary class="mobile-facets__summary">
                            <div>
                              <span>{{ filter.label | escape }}</span>
                              <span class="count-bubble">
                                {%- if filter.active_values.size > 0 -%}{{ filter.active_values.size }}{%- endif -%}
                              </span>
                              <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                              <noscript>{% render 'icon-caret' %}</noscript>
                            </div>
                          </summary>
                          <div class="mobile-facets__submenu py-{{section.settings.filter_bg_color}}">
                            <button class="mobile-facets__close-button link link--text focus-inset" aria-expanded="true" type="button">
                              {% render 'icon-arrow' %}
                              {{ filter.label | escape }}
                            </button>
                            <ul class="mobile-facets__list list-unstyled" role="list">
                              {%- for value in filter.values -%}
                                <li class="mobile-facets__item list-menu__item">
                                  <label for="Filter-{{ filter.label | escape }}-mobile-{{ forloop.index }}" class="mobile-facets__label{% if value.count == 0 and value.active == false %} mobile-facets__label--disabled{% endif %}">
                                    <input class="mobile-facets__checkbox"
                                      type="checkbox"
                                      name="{{ value.param_name }}"
                                      value="{{ value.value }}"
                                      id="Filter-{{ filter.label | escape }}-mobile-{{ forloop.index }}"
                                      onclick="selectOnlyThis(this,'Filter-{{ block.settings.label | escape }}')"
                                      {% if value.active %}checked{% endif %}
                                      {% if value.count == 0 and value.active == false %}disabled{% endif %}
                                    >

                                    <span class="mobile-facets__highlight"></span>

                                    <svg width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                      <rect width="16" height="16" stroke="currentColor" fill="none" stroke-width="1"></rect>
                                    </svg>

                                    <svg class="icon icon-checkmark" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none" width="10px" height="10px">
                                      <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"/>
                                    </svg>

                                    {{ value.label | escape }} ({{ value.count }})
                                  </label>
                                </li>
                              {%- endfor -%}
                            </ul>

                            <div class="no-js-hidden mobile-facets__footer py-{{section.settings.filter_bg_color}}">
                              <a href="{{ collection.url }}" class="mobile-facets__clear button button--secondary js-facet-remove">{{ 'sections.collection_template.clear' | t }}</a>
                              <button type="button" class="no-js-hidden button button--primary" onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()">{{ 'sections.collection_template.apply' | t }}</button>
                              <noscript><button class="button button--primary">{{ 'sections.collection_template.apply' | t }}</button></noscript>
                            </div>
                          </div>
                        </details>
                      {% when 'price_range' %}
                        <details class="mobile-facets__details js-filter" data-index="mobile-{{ forloop.index }}">
                          <summary class="mobile-facets__summary">
                            <div>
                              <span>{{ filter.label | escape }}</span>
                              <span class="count-bubble{%- if filter.min_value.value or filter.max_value.value -%}{{ filter.active_values.size }} count-bubble--dot{% endif %}"></span>
                              <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                              <noscript>{% render 'icon-caret' %}</noscript>
                            </div>
                          </summary>
                          <div class="mobile-facets__submenu py-{{section.settings.filter_bg_color}}">
                            <button class="mobile-facets__close-button link link--text focus-inset" aria-expanded="true" type="button">
                              {% render 'icon-arrow' %}
                              {{ filter.label | escape }}
                            </button>

                            <p class="mobile-facets__info">{{ "sections.collection_template.max_price" | t: price: max_price_amount }}</p>

                            <price-range class="facets__price">
                              <div class="field">
                                <span class="field__currency">{{ cart.currency.symbol }}</span>
                                <input class="field__input"
                                  name="{{ filter.min_value.param_name }}"
                                  id="Filter-{{ filter.label | escape }}-{{ forloop.index }}"
                                  {%- if filter.min_value.value -%}
                                    {%- if uses_comma_decimals -%}
                                      value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                    {%- else -%}
                                      value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                                    {% endif %}
                                  {%- endif -%}
                                  type="number"
                                  placeholder="0"
                                  min="0"
                                  max="{{ filter.range_max | divided_by: 100 | ceil }}"/>
                                <label class="field__label" for="Search-In-Modal">{{ 'sections.collection_template.from' | t }}</label>
                              </div>
                              <div class="field">
                                <span class="field__currency">{{ cart.currency.symbol }}</span>
                                <input class="field__input"
                                  name="{{ filter.max_value.param_name }}"
                                  id="Filter-{{ filter.label | escape }}-{{ forloop.index }}"
                                  {%- if filter.max_value.value -%}
                                    {%- if uses_comma_decimals -%}
                                      value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                    {%- else -%}
                                      value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                                    {% endif %}
                                  {%- endif -%}
                                  type="number"
                                  placeholder="{{ filter.range_max | divided_by: 100 | ceil }}"
                                  min="0"
                                  max="{{ filter.range_max | divided_by: 100 | ceil }}"/>
                                <label class="field__label" for="Search-In-Modal">{{ 'sections.collection_template.to' | t }}</label>
                              </div>
                            </price-range>
                          </div>
                        </details>
                      {% endcase %}
                    {%- endfor -%}
                  {% endif %}

                  

                  <div class="mobile-facets__footer py-{{section.settings.filter_bg_color}}">
                    <a href="{{ collection.url }}" class="mobile-facets__clear button button--secondary js-facet-remove">{{ 'sections.collection_template.clear' | t }}</a>
                    <button type="button" class="no-js-hidden button button--primary" onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()">{{ 'sections.collection_template.apply' | t }}</button>
                    <noscript><button class="button button--primary">{{ 'sections.collection_template.apply' | t }}</button></noscript>
                  </div>
                </div>

                {% if collection.current_vendor or collection.current_type %}
                  <input type="hidden" name="q" value="{{ collection.current_vendor }}{{ collection.current_type }}">
                {% endif %}
              </div>
            </form>
          </collection-filters-form>
        </details>
      </menu-drawer>

      <div class="active-facets active-facets-mobile">
        <a href="{{ collection.url }}?sort_by={{ sort_by }}" class="active-facets__button button button--secondary js-facet-remove" data-type="clear_all">{{ 'sections.collection_template.clear_all' | t }}</a>
        {%- for filter in collection.filters -%}
          {%- for value in filter.active_values -%}
            <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ value.url_to_remove }}" data-value="{{ value.value | escape }}">
              {{ value.label | escape }}
              {% render 'icon-close-small' %}
            </a>
          {%- endfor -%}

          {% if filter.type == "price_range" %}
            {%- if filter.min_value.value != nil or filter.max_value.value != nil -%}
              <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ filter.url_to_remove }}">
                {%- if filter.min_value.value -%}{{ filter.min_value.value | money }}{%- else -%}{{ 0 | money }}{%- endif -%}-{%- if filter.max_value.value -%}{{ filter.max_value.value | money }}{%- else -%}{{ filter.range_max | money }}{%- endif -%}
                {% render 'icon-close-small' %}
              </a>
            {%- endif -%}
          {% endif %}
        {%- endfor -%}
        {%- if current_tags != blank -%}
          {%- for tag in current_tags -%}
            <a class="active-facets__button active-facets__button--light button button--tertiary js-facet-remove" href="{{ tag | escape }}" data-type="{{ tag | escape }}" data-value="{{ tag | escape }}">
              {{ tag | remove: "C_COVERAGES_" | remove: "C_FABRICS_" | remove: "C_TYPES_" | escape }}
              {% render 'icon-close-small' %}
            </a>
          {%- endfor -%}
        {%- endif -%}
      </div>
    {%- endif -%}

    
  </div>

  <script src="{{ 'collection-filters-form.js' | asset_url }}" defer="defer"></script>