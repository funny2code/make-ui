<!DOCTYPE html>
<html>
    <head>
        <title><%= make.title %></title>
        <link rel='stylesheet' href='/stylesheets/style.css' />
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    </head>
    <body>
        <%- include('make/header', {id: id, themeName: settings ? settings[0]?.theme_name : null }) %>
        <div class="py__make">
            <div class="py__make-sidebar">
                <% if(sidebar){ %>
                    <%- include('./make/left-sidebar') %> 
                <% } %>
            </div>
            <div class="py__make-preview">
                <div class="py__preview-content">
                    <div class="py__preview-settings">
                        <% if(pageNames){ %>
                        <div class="py__preview-select">
                            <select class="py__preview-pages-select">
                                <% pageNames.forEach(item => { %> 
                                    <option data-href="/themes/<%=id%>?page=<%=item.name%>" <% if(page === item.name){ %>selected<% } %>>
                                        <%=item.name%>
                                    </option>
                                <% }) %>
                            </select>
                        </div>
                        <% } %> 
                        <div class="py__preview-buttons">
                            <button type="button" data-type="desktop" data-view="100%" class="py__button py__button-view active">
                                <%- include('icons', {type: 'desktop'}) %>
                                Desktop
                            </button>
                            <button type="button" data-type="tablet" data-view="768px" class="py__button py__button-view">
                                <%- include('icons', {type: 'tablet'}) %>
                                Tablet
                            </button>
                            <button type="button" data-type="mobile" data-view="425px" class="py__button py__button-view">
                                <%- include('icons', {type: 'tablet'}) %>
                                Mobile
                            </button>
                        </div>
                    </div>
                    <div class="py__preview-iframe">
                        <div class="py__loading-wrap">
                            <div class="py__full-loading">
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                            </div>
                        </div>
                        <iframe src="/view/<%= id %>?page=<%=page%><% if(activeType === 'section'){%>&section=<%=active%><% } else { %>&global=<%=active%><% } %>" class="py__view-iframe"></iframe>
                    </div>
                </div>
            </div>
            <div class="py__make-settings">
                <% if(pageSections && section){ %>
                    <select class="py__sections-dropdown-listener">
                        <% pageSections.forEach((item, index)=>{ %>
                            <option value="<%=item.name%>" data-href="/themes/<%=id%>?page=<%=page%>&section=<%=item.name%>" <% if(item.name === active){ %>selected<% } %>>
                                <%=item.name%>
                            </option>
                        <% }) %> 
                    </select>
                <% } %>
                <form class="py__settings-form <% if(!section){ %>py__settings-form-mgtop<% } %>" method="post" action="/save/<%= id %>?<% if(activeType === 'section'){%>section=<%=active%><% } else { %>global=<%=active%><% } %>" aria-multiline="true">
                    <% if(pageSections && !settings && !section){ %>
                        <div class="py__settings-content">
                            <div class="py__loading-wrap">
                                <div class="py__full-loading">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                            </div>
                            <h2 class="py__settings-heading py__back-button-wrap"><%=page%> Sections</h2>
                            <% pageSections.forEach((item, index)=>{ %>
                                <a href="/themes/<%=id%>?page=<%=page%>&section=<%=item.name%>" class="py__section-item-href py__get-section-button <% if(item.name === active){ %>active<% } %>">
                                    <span class="py__section-item-href-name"><%= item.name %></span>
                                    <span><%- include('icons', {type:'arrow_right'}) %></span>
                                </a>
                            <% }) %> 
                        </div>
                    <% } %>
                    <% if(settings){ %> 
                        <div class="py__settings-content">
                            <div class="py__loading-wrap">
                                <div class="py__full-loading">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                            </div>
                            <% settings.forEach(comp => { %>
                                <h2 class="py__settings-heading"><%= comp.name %></h2>
                                <% if(comp.settings){ %>
                                    <%- include('make/settings', {settings: comp.settings, global: "settings"}) %>
                                <% } else { %>
                                    <%- include('components/brand', {name: comp.theme_name}) %>
                                <% } %>
                            <% }) %>
                        </div>
                    <% } %>
                    <% if(section){ %>
                        <div class="py__settings-content">
                            <div class="py__loading-wrap">
                                <div class="py__full-loading">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                            </div>
                            <h2 class="py__settings-heading"><%= section.name %></h2>
                            <% if(section.settings){ %>
                                <%- include('make/settings', {settings: section.settings, global: "section"}) %>
                            <% } %>
                            <% if(section.blocks){ %>
                                <h2 class="py__settings-heading">Blocks</h2>
                                <%- include('make/blocks', {blocks: section.blocks, global: "block"}) %>
                            <% } %>
                        </div>
                    <% } %>
                </form>
            </div>
            <div class="py__full-loading-wrapper">
                <div class="py__full-loading">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
        <script src="/javascripts/make.js"></script>
    </body>
</html>
