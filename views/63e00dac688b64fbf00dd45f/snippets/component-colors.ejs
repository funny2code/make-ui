<div class="bc-colors bc-colors-<%= settings.c_s_style %>">
    <% var productType = product.type | handleize | prepend: 'color-'){ %>
    <% var productColorTitle = product.title?.split(' / '?.pop()){ %>
    <% var productColorImage = productColorTitle?.trim() | replace: ' ', '_'.toLowerCase() | prepend: 'c_'){ %>
    <% var productColor = productColorTitle?.trim() | replace: ' ', '_'.toLowerCase() | prepend: 'c_bg_'){ %>
    <% if(show_heading){ %>
        <h2 class="bc-colors__heading"> 
        <% if(settings.c_s_style === 'style-2'){ %>
        COLOR <b><%= productColorTitle %></b>
        <% } else { %>
        CHOOSE A COLOR
        <% } %>
        </h2>
    <% } %>
    <% if(collections[productType].products.length > 0){ %>
    <% for prod in collections[productType].products){ %>
        <% var colorTitle = prod.title?.split(' / '?.pop()){ %>        
        <% var color = colorTitle?.trim() | replace: ' ', '-'.toLowerCase() ){ %>
        <% if(colorTitle === productColorTitle){ %>
        <div class="bc-colors__item bc-colors__item-selected">
            <div class="bc-colors__icon" 
            data-color="<%=color%>"
            <% if(settings.c_s_style === 'style-2'){ %>title="<%=colorTitle%>"<% } %>></div>
            <% if(settings.c_s_style === 'style-1'){ %>
                <span class="bc-colors__name"><%= colorTitle %></span>
            <% } %>
        </div>
        <% } else { %>
        <div class="bc-colors__item">
            <a href="<%= prod.url %>">
            <div class="bc-colors__icon" 
            data-color="<%=color%>"
            <% if(settings.c_s_style === 'style-2'){ %>title="<%=colorTitle%>"<% } %>>
            </div>
            <% if(settings.c_s_style === 'style-1'){ %>
                <span class="bc-colors__name"><%= colorTitle %></span>
            <% } %>
            </a>
        </div>
        <% } %>
    <% }) %>
    <% } else { %>
    <div class="bc-colors__item bc-colors__item-selected">
        <div class="bc-colors__icon" 
        <% if(settings[productColorImage]){ %>style="background-image: url(<%= settings[productColorImage] | img_url: '50x' %>);"<% } else if(settings[productColor]){ %>style="background-color:<%= settings[productColor] %>;"<% } %>
        <% if(settings.c_s_style === 'style-2'){ %>title="<%=productColorTitle%>"<% } %>></div>
        <% if(settings.c_s_style === 'style-1'){ %>
            <span class="bc-colors__name"><%= productColorTitle %></span>
        <% } %>
    </div>
    <% } %>
</div>